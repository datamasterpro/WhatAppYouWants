<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Interview App Feedback</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // SVG Icon Components
        const ThumbsUp = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M7 10v12M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z"/>
            </svg>
        );
        
        const ThumbsDown = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M17 14V2M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z"/>
            </svg>
        );
        
        const Download = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
            </svg>
        );
        
        const Send = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/>
            </svg>
        );
        
        const Lightbulb = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/>
                <path d="M9 18h6M10 22h4"/>
            </svg>
        );
        
        const Users = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
        );
        
        const CheckCircle = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
        );

        function InterviewAppFeedback() {
            const [features, setFeatures] = useState([
                { id: 1, title: "Warm Up", description: "Practice with easier questions to get comfortable before the main interview", likes: 0, dislikes: 0 },
                { id: 2, title: "Complete 45-Minute Interview", description: "Full interview session based on your resume with AI-powered questions", likes: 0, dislikes: 0 },
                { id: 3, title: "Companies Hiring DA", description: "Updated list of companies currently hiring Data Analysts", likes: 0, dislikes: 0 },
                { id: 4, title: "Company-Based Interview Questions", description: "Practice with questions specific to companies you're targeting", likes: 0, dislikes: 0 },
                { id: 5, title: "DA Technical Questions", description: "Practice SQL, Tableau, and other data analytics technical skills", likes: 0, dislikes: 0 }
            ]);

            const [userVotes, setUserVotes] = useState({});
            const [loading, setLoading] = useState(true);
            const [suggestions, setSuggestions] = useState([]);
            const [newSuggestion, setNewSuggestion] = useState('');
            const [submitting, setSubmitting] = useState(false);
            const [surveyAnswers, setSurveyAnswers] = useState({});
            const [allSurveyResponses, setAllSurveyResponses] = useState([]);
            const [surveySubmitted, setSurveySubmitted] = useState(false);
            const [userId] = useState(() => {
                const stored = localStorage.getItem('userId');
                if (stored) return stored;
                const newId = 'user_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('userId', newId);
                return newId;
            });

            const surveyQuestions = [
                { id: 'difficulty', question: 'What do you currently find most difficult when preparing for data analyst interviews?*', type: 'multiple',
                  options: ['SQL questions', 'Python coding', 'Statistics & Probability', 'Data visualization tools (Power BI/Tableau)', 'Behavioural questions', 'Communication and explaining dashboards'] },
                { id: 'format', question: 'Which interview formats do you prefer practicing?*', type: 'multiple',
                  options: ['Multiple choice', 'Mock interviews', 'Topic-based practice', 'Self-paced questions', 'Timed questions'] },
                { id: 'frequency', question: 'How often do you plan to use a practice app like this?*', type: 'single',
                  options: ['Daily', 'A few times per week', 'Once a week', 'Only before interviews when I get a call', 'Occasionally'] },
                { id: 'level', question: 'What level of technical depth do you expect from this platform?*', type: 'single',
                  options: ['Beginner', 'Intermediate', 'Advanced', 'Mix of all levels'] },
                { id: 'confidence', question: 'How do you want this application to help build your confidence before interviews?', type: 'text', placeholder: 'Share your thoughts...' },
                { id: 'wishlist', question: 'Is there a feature you wish this app had that others don\'t? Feel free to give your suggestions.', type: 'text', placeholder: 'Your feature ideas...' }
            ];

            useEffect(() => { loadAllData(); }, []);

            const loadAllData = () => {
                setLoading(true);
                const updatedFeatures = features.map(feature => {
                    const stored = localStorage.getItem(`feature_${feature.id}`);
                    return stored ? { ...feature, ...JSON.parse(stored) } : feature;
                });
                setFeatures(updatedFeatures);

                const userVoteData = localStorage.getItem(`user_votes_${userId}`);
                if (userVoteData) setUserVotes(JSON.parse(userVoteData));

                const suggestionsData = localStorage.getItem('feature_suggestions');
                if (suggestionsData) setSuggestions(JSON.parse(suggestionsData));

                const surveyData = localStorage.getItem('survey_responses');
                if (surveyData) setAllSurveyResponses(JSON.parse(surveyData));

                if (localStorage.getItem(`user_survey_${userId}`)) setSurveySubmitted(true);
                setLoading(false);
            };

            const handleVote = (featureId, voteType) => {
                const currentVote = userVotes[featureId];
                let newVotes = { ...userVotes };
                const feature = features.find(f => f.id === featureId);
                let newLikes = feature.likes, newDislikes = feature.dislikes;

                if (currentVote === voteType) {
                    voteType === 'like' ? newLikes-- : newDislikes--;
                    delete newVotes[featureId];
                } else if (currentVote) {
                    currentVote === 'like' ? newLikes-- : newDislikes--;
                    voteType === 'like' ? newLikes++ : newDislikes++;
                    newVotes[featureId] = voteType;
                } else {
                    voteType === 'like' ? newLikes++ : newDislikes++;
                    newVotes[featureId] = voteType;
                }

                localStorage.setItem(`feature_${featureId}`, JSON.stringify({ likes: newLikes, dislikes: newDislikes }));
                localStorage.setItem(`user_votes_${userId}`, JSON.stringify(newVotes));
                setFeatures(features.map(f => f.id === featureId ? { ...f, likes: newLikes, dislikes: newDislikes } : f));
                setUserVotes(newVotes);
            };

            const handleSurveyAnswerChange = (questionId, value, isMultiple = false) => {
                if (isMultiple) {
                    const currentAnswers = surveyAnswers[questionId] || [];
                    const newAnswers = currentAnswers.includes(value) ? currentAnswers.filter(v => v !== value) : [...currentAnswers, value];
                    setSurveyAnswers({ ...surveyAnswers, [questionId]: newAnswers });
                } else {
                    setSurveyAnswers({ ...surveyAnswers, [questionId]: value });
                }
            };

            const handleSubmitSurvey = () => {
                const requiredQuestions = ['difficulty', 'format', 'frequency', 'level'];
                const missingRequired = requiredQuestions.filter(q => !surveyAnswers[q] || (Array.isArray(surveyAnswers[q]) && surveyAnswers[q].length === 0));
                if (missingRequired.length > 0) { alert('Please answer all required questions (marked with *)'); return; }

                setSubmitting(true);
                const response = { id: Date.now(), userId, answers: surveyAnswers, timestamp: new Date().toISOString() };
                const updatedResponses = [...allSurveyResponses, response];
                localStorage.setItem('survey_responses', JSON.stringify(updatedResponses));
                localStorage.setItem(`user_survey_${userId}`, JSON.stringify(response));
                setAllSurveyResponses(updatedResponses);
                setSurveySubmitted(true);
                alert('Thank you! Your survey has been submitted successfully.');
                setSubmitting(false);
            };

            const handleSubmitSuggestion = () => {
                if (!newSuggestion.trim()) return;
                setSubmitting(true);
                const suggestion = { id: Date.now(), text: newSuggestion.trim(), userId, timestamp: new Date().toISOString() };
                const updatedSuggestions = [...suggestions, suggestion];
                localStorage.setItem('feature_suggestions', JSON.stringify(updatedSuggestions));
                setSuggestions(updatedSuggestions);
                setNewSuggestion('');
                alert('Thank you! Your suggestion has been submitted.');
                setSubmitting(false);
            };

            const downloadExcel = () => {
                const featuresData = features.map((feature, index) => {
                    const total = feature.likes + feature.dislikes;
                    return { Rank: index + 1, Feature: feature.title, Description: feature.description, Likes: feature.likes, 
                            Dislikes: feature.dislikes, 'Total Votes': total, 'Approval %': total > 0 ? ((feature.likes / total) * 100).toFixed(1) : 0 };
                }).sort((a, b) => b.Likes - a.Likes);

                const suggestionsData = suggestions.map((s, i) => ({ '#': i + 1, 'Suggested Feature': s.text, 'Submitted On': new Date(s.timestamp).toLocaleString() }));

                const surveyData = allSurveyResponses.map((r, i) => {
                    const a = r.answers;
                    return { 'Response #': i + 1, 'Most Difficult': Array.isArray(a.difficulty) ? a.difficulty.join(', ') : a.difficulty,
                            'Preferred Format': Array.isArray(a.format) ? a.format.join(', ') : a.format, 'Usage Frequency': a.frequency || '',
                            'Technical Level': a.level || '', 'Confidence Building': a.confidence || '', 'Feature Wishlist': a.wishlist || '',
                            'Submitted On': new Date(r.timestamp).toLocaleString() };
                });

                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(featuresData), 'Feature Votes');
                if (suggestionsData.length > 0) XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(suggestionsData), 'User Suggestions');
                if (surveyData.length > 0) XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(surveyData), 'Survey Responses');
                XLSX.writeFile(wb, `AI_Interview_App_Feedback_${new Date().toISOString().split('T')[0]}.xlsx`);
            };

            const totalVotes = features.reduce((sum, f) => sum + f.likes + f.dislikes, 0);
            const sortedFeatures = [...features].sort((a, b) => b.likes - a.likes);

            if (loading) {
                return <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
                    <div className="text-center"><div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                    <p className="text-gray-600">Loading feedback...</p></div></div>;
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
                    <div className="max-w-4xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-lg p-8 mb-6">
                            <div className="flex justify-between items-start mb-4">
                                <div className="flex-1">
                                    <h1 className="text-3xl font-bold text-gray-800 mb-2">AI Interview Prep App üéØ</h1>
                                    <p className="text-gray-600 mb-4">Help us build the perfect Data Analyst interview preparation tool!</p>
                                </div>
                                <button onClick={downloadExcel} className="flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                                    <Download className="w-4 h-4" /><span className="font-medium">Export Excel</span>
                                </button>
                            </div>
                            <div className="flex items-center gap-4 text-sm text-gray-500 flex-wrap">
                                <div className="flex items-center gap-2"><Users className="w-4 h-4" /><span>{totalVotes} votes</span></div>
                                <div className="flex items-center gap-2"><Lightbulb className="w-4 h-4" /><span>{suggestions.length} suggestions</span></div>
                                <div className="flex items-center gap-2"><CheckCircle className="w-4 h-4" /><span>{allSurveyResponses.length} survey responses</span></div>
                            </div>
                        </div>

                        {!surveySubmitted && (
                            <div className="bg-white rounded-2xl shadow-lg p-8 mb-6">
                                <h2 className="text-2xl font-bold text-gray-800 mb-2">üìã Quick Survey</h2>
                                <p className="text-gray-600 mb-6">Help us understand your needs better (2 minutes)</p>
                                <div className="space-y-6">
                                    {surveyQuestions.map((q) => (
                                        <div key={q.id} className="pb-6 border-b last:border-b-0">
                                            <label className="block text-gray-800 font-medium mb-3">{q.question}</label>
                                            {q.type === 'text' ? (
                                                <textarea value={surveyAnswers[q.id] || ''} onChange={(e) => handleSurveyAnswerChange(q.id, e.target.value)}
                                                    placeholder={q.placeholder} className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3" />
                                            ) : q.type === 'multiple' ? (
                                                <div className="space-y-2">
                                                    {q.options.map((option) => (
                                                        <label key={option} className="flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer">
                                                            <input type="checkbox" checked={(surveyAnswers[q.id] || []).includes(option)}
                                                                onChange={() => handleSurveyAnswerChange(q.id, option, true)} className="w-4 h-4 text-blue-600" />
                                                            <span className="text-gray-700">{option}</span>
                                                        </label>
                                                    ))}
                                                </div>
                                            ) : (
                                                <div className="space-y-2">
                                                    {q.options.map((option) => (
                                                        <label key={option} className="flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer">
                                                            <input type="radio" name={q.id} checked={surveyAnswers[q.id] === option}
                                                                onChange={() => handleSurveyAnswerChange(q.id, option)} className="w-4 h-4 text-blue-600" />
                                                            <span className="text-gray-700">{option}</span>
                                                        </label>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                                <button onClick={handleSubmitSurvey} disabled={submitting}
                                    className="mt-6 w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed">
                                    {submitting ? 'Submitting...' : 'Submit Survey'}
                                </button>
                            </div>
                        )}

                        {surveySubmitted && (
                            <div className="bg-green-50 border border-green-200 rounded-xl p-6 mb-6">
                                <div className="flex items-center gap-3">
                                    <CheckCircle className="w-6 h-6 text-green-600" />
                                    <div><h3 className="font-semibold text-green-800">Survey Completed!</h3>
                                    <p className="text-green-700 text-sm">Thank you for your feedback. Continue voting on features below.</p></div>
                                </div>
                            </div>
                        )}

                        <div className="bg-white rounded-2xl shadow-lg p-8 mb-6">
                            <h2 className="text-2xl font-bold text-gray-800 mb-6">üëç Vote on Features</h2>
                            <div className="space-y-4">
                                {features.map((feature) => {
                                    const totalFeatureVotes = feature.likes + feature.dislikes;
                                    const likePercentage = totalFeatureVotes > 0 ? Math.round((feature.likes / totalFeatureVotes) * 100) : 0;
                                    const userVoted = userVotes[feature.id];
                                    return (
                                        <div key={feature.id} className="p-6 bg-gray-50 rounded-xl border border-gray-200">
                                            <div className="mb-3">
                                                <h3 className="text-xl font-semibold text-gray-800 mb-2">{feature.title}</h3>
                                                <p className="text-gray-600 text-sm">{feature.description}</p>
                                            </div>
                                            <div className="flex items-center gap-4">
                                                <button onClick={() => handleVote(feature.id, 'like')}
                                                    className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${
                                                        userVoted === 'like' ? 'bg-green-500 text-white' : 'bg-white border border-gray-300 text-gray-700 hover:bg-green-50'}`}>
                                                    <ThumbsUp className="w-5 h-5" /><span className="font-semibold">{feature.likes}</span>
                                                </button>
                                                <button onClick={() => handleVote(feature.id, 'dislike')}
                                                    className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${
                                                        userVoted === 'dislike' ? 'bg-red-500 text-white' : 'bg-white border border-gray-300 text-gray-700 hover:bg-red-50'}`}>
                                                    <ThumbsDown className="w-5 h-5" /><span className="font-semibold">{feature.dislikes}</span>
                                                </button>
                                                {totalFeatureVotes > 0 && (
                                                    <div className="ml-auto text-sm text-gray-600">
                                                        <span className="font-semibold text-green-600">{likePercentage}%</span> approval
                                                    </div>
                                                )}
                                            </div>
                                            {totalFeatureVotes > 0 && (
                                                <div className="mt-3 h-2 bg-gray-200 rounded-full overflow-hidden">
                                                    <div className="h-full bg-green-500 transition-all duration-300" style={{ width: `${likePercentage}%` }} />
                                                </div>
                                            )}
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        <div className="bg-white rounded-xl shadow-md p-6 mb-6">
                            <div className="flex items-center gap-2 mb-4">
                                <Lightbulb className="w-6 h-6 text-yellow-500" />
                                <h2 className="text-xl font-bold text-gray-800">Suggest a Feature</h2>
                            </div>
                            <div className="flex gap-3">
                                <input type="text" value={newSuggestion} onChange={(e) => setNewSuggestion(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && handleSubmitSuggestion()} placeholder="Type your feature suggestion..."
                                    className="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" disabled={submitting} />
                                <button onClick={handleSubmitSuggestion} disabled={!newSuggestion.trim() || submitting}
                                    className="flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300">
                                    <Send className="w-4 h-4" />
                                </button>
                            </div>
                        </div>

                        {totalVotes > 0 && (
                            <div className="bg-white rounded-2xl shadow-lg p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4">üìä Feature Rankings</h2>
                                <div className="space-y-2">
                                    {sortedFeatures.map((feature, index) => {
                                        const total = feature.likes + feature.dislikes;
                                        const approval = total > 0 ? Math.round((feature.likes / total) * 100) : 0;
                                        return (
                                            <div key={feature.id} className="flex items-center justify-between py-3 border-b last:border-b-0">
                                                <div className="flex items-center gap-3">
                                                    <span className="text-2xl font-bold text-gray-400">#{index + 1}</span>
                                                    <div>
                                                        <span className="font-medium text-gray-700 block">{feature.title}</span>
                                                        <span className="text-xs text-gray-500">{approval}% approval</span>
                                                    </div>
                                                </div>
                                                <div className="flex items-center gap-2">
                                                    <span className="text-green-600 font-semibold">{feature.likes} üëç</span>
                                                    <span className="text-gray-400">|</span>
                                                    <span className="text-red-600 font-semibold">{feature.dislikes} üëé</span>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<InterviewAppFeedback />, document.getElementById('root'));
    </script>
</body>
</html>
